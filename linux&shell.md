#第二章 走进shell#

　　在图形化界面出现前，与Unix系统进行交互的唯一方式是借助shell所提供的文本命令行界面（command line interface，CLI）。CLI只能接受文本输入，也只能显示出文本和基本的图形输出。<br>
　　在大多数linux发行版中，可以通过按下Ctrl+Alt组合键，然后按下功能键（F1~F7）来进入要使用的虚拟控制台。通常F1或F7是进入图形界面。Ubuntu是使用F7。

	setterm命令
	选项：
		-background		[black|red|green|yellow|blue|magenta|cyan|white]
						修改中断的背景色
		-foreground		[black|red|green|yellow|blue|magenta|cyan|white]
						修改终端的前景色
		-inversescreen 	[on|off]
						交换前景色和背景色
		-reset			none
						将终端外观恢复为默认设置并清屏
		-store			none
						将当前前景色和背景色设置为-reset选项的值

<br><br>
#第三章 bash手册#

##3.3 bash手册##

	man命令
		man <命令>
			查找命令手册，按空格翻页，按回车逐行查看，按q离开
		man  -k <命令关键词>
			按关键词查找命令

　　手册页将命令相关的信息分成不同的节，每一节惯用的命名标准如下：

	 节                                 描述
	------------------------------------------------------------
	Name                            显示命令名和一段简短的描述
	Synopsis                        命令的语法
	Configuration                   命令的配置信息
	Description                     命令的一般描述
	Options                         命令选项描述
	Exit Status                     命令的退出状态指示
	Return Value                    命令的返回值
	Error                           命令的错误信息
	Enviroment                      描述所使用的环境变量
	Files                           命令用到的文件
	Versions                        命令的版本信息
	Conforming To                   命令所遵从的标准
	Notes                           其他有帮助的资料
	Bugs                            提供提交bug的途径
	Example                         展示命令的用法
	Author                          命令开发人员信息
	Copyright                       命令源代码的版权状况
	See Also                        其他该命令类型的命令

　　还可以使用 info <命令> 及 <命令> -help 查看更多帮助信息。

##3.4浏览文件系统##

　　Linux将文件存储在单个目录结构中，这个目录结构称为虚拟目录（virtual directory）。虚拟目录将安装在PC上的所有存储设备的文件路径纳入耽搁目录结构中。
　　Linux虚拟目录结构只包含一个称为根（root）目录的基础目录。Linux中使用正斜线（/）在文件路径中划分目录。而反斜线（\）用来标识转义字符。
　　在Linux PC上安装的第一块硬盘称为根驱动器。根驱动器包含了虚拟目录的核心，其他目录都是从那里开始创建的。Linux会在根驱动器上创建一些特别的目录，称为挂载点（mount point）。挂载点是虚拟目录中用于分配额外存储设备的目录。虚拟目录会让文件和目录出现在这些挂载点目录中，然而实际上他们却存储在另外一个驱动器中。通常系统文件会存储在根驱动器中，而用户文件则存储在另一个驱动器中。

　　常见的Linux目录名称如下:

	 目录								用途
	------------------------------------------------------------------------
	/                               虚拟目录的根目录。通常不会在这里存储文件
	/bin                            二进制目录，存放很多用户级的GNU工具
	/boot                           启动目录，存放启动文件
	/dev                            设备目录，Linux在这里创建设备节点
	/etc                            系统配置文件目录
	/home                           主目录，Linux在这里创建用户目录
	/lib                            库目录，存放系统和应用程序的库文件
	/media                          媒体目录，可移动媒体设备的常用挂载点
	/mnt                            挂载目录，另一个可移动媒体设备的常用挂载点
	/opt							可选目录，常用于存放第三方软件包和数据文件
	/proc                           进程目录，存放现有硬件及当前进程的相关信息
	/root                           root用户的主目录
	/sbin                           系统二进制目录，存放许多GNU管理员级工具
	/run                            运行目录，存放系统运行时的运行时数据
	/srv                            服务目录，存放本地服务的相关文件
	/sys                            系统目录，存放系统硬件信息的相关文件
	/tmp                            临时目录，可以在该目录中创建和删除临时工作文件
	/usr                            用户二进制目录，大量用户级的GNU工具和数据文件都存储在这里
	/var                            可变目录，用来存放经常变化的文件，比如日志文件

　　切换目录命令:

	cd <destination>

　　显示当前所在目录：

	pwd

　　destination参数可以用两种方式表示：一种是绝对文件路径，另一种是使用相对文件目录。绝对文件路径总是以正斜线（/）作为开始，指明虚拟目录的根目录。可以清晰表明用户想切换到的确切位置。相对文件路径允许用户指定一个基于当前位置的目标文件路径。相对文件路径不以代表根目录的正斜线（/）开头，而是以目录名（如果用户准备切换到当前工作目录下的一个目录）或是一个特殊字符开始。有两个特殊字符可用于相对文件路径中：

	单点符（.），表示当前目录
	双点符（..），表示目前目录的父目录

##3.5 文件和目录列表##

　　列表命令（ls），ls命令输出的列表是按字母排序的（按列排序而不是按行排序）。若终端仿真器支持彩色，会用不同的颜色区分不同类型的文件。LS_COLORS控制这个功能。若不支持彩色，可用带-F参数的ls命令区分文件和目录。-F参数会在目录名后面加正斜线（/）来区分，在可执行文件后面加星号（*），在软链接文件后加'@'。

	ls -F

　　Linux常用隐藏文件来保存配置信息。隐藏文件通常是文件名以点号（.）开头的文件。这些文件不会在默认的ls命令输出中显示出来，若要显示这些隐藏文件，就需要-a参数。

	ls -a

　　-R参数会列出当前目录下包含的子目录下的文件，称为递归选项。

	ls -R

　　基本的ls命令不会输出太多每个文件的相关信息。要显示附加信息，常用的参数为-l。这种长列表格式的输出在每一行中列出了单个文件或文件。除了文件名，还包含一下信息：

- 文件类型，如目录（d），是directory的缩写；文件（-）；链接（l），是link的缩写；字符型文件（c），是character的缩写，该文件是一个字符设备文件，即一次传输一个字节的设备如键盘或字符型终端；块设备（b），是block的缩写，块设备是一次传输一整块数据的设备，如硬盘，光盘等，最小数据传输单位为一个数据块，通常为512字节；命令管道（p），sock（s）。
- 文件权限，三个一组，分别代表主权限，组权限和其他用户权限。-代表无权限，r代表具有可读权限，w代表具有可写权限，x代表具有可执行权限。
- 文件的硬链接总数。
- 文件属主的用户名。
- 文件属组的组名。
- 文件大小。
- 文件的上次修改时间。
- 文件名或目录名

　　ls命令支持在命令行中定义过滤器来决定显示哪些文件或目录。这个过滤器就是一个进行简单文本匹配的字符串。可在命令行参数之后添加过滤器。支持通配符。

- 问号（?），代表一个任意字符。
- 星号（*），代表零个或多个字符。
- 中括号及可能出现的字符，如[ai]表示a或者i，[a - i]表示从a到i的一个字符。
- 感叹号（!），排除一些字符。
- ……

##3.6 处理文件##

　　touch命令可以创建指定新文件，并将你的用户名作为文件属主。文件大小为零，因为touch值创建一个空文件。touch文件还可以用来改变文件的修改时间，这个操作并不改变文件的内容。若只想修改访问时间，可用-a参数。只是用ls -l命令，不会显示访问时间，若想查看访问时间，需要加入另一个参数：--time=atime。

	$ touch test
	$ ll test
	-rw-r--r--. 1 root root 520 8月  12 02:23 test
	$ touch test
	$ ll test
	-rw-r--r--. 1 root root 520 8月  12 02:24 test
	$ touch -a test
	$ ll test
	-rw-r--r--. 1 root root 520 8月  12 02:24 test
	$ ll --time=atime test
	-rw-r--r--. 1 root root 520 8月  12 02:25 test

　　cp命令可以在文件系统中，将文件和目录从一个位置复制到另一个位置。在基本的用法中，cp命令需要两个参数————源对象和目标对象：

	cp <source> <destination>

　　当source和destination参数都是文件名时，cp命令将源文件复制成一个新文件，并且destination命名。若destination为目录名，则将源文件复制到destination目录下，和源文件同名。新文件像全新文件一样，有新的修改时间。如果目标文件已经存在，cp命令会自动覆盖。加上-i参数，可以强制shell询问是否需要覆盖已有文件。

　　-R参数可以递归地复制整个目录的内容。

	cp -R <source> <destination>

　　支持通配符。
　　shell还有制表键自动补全功能。自动补全允许在输入文件名或目录名时按一下制表键，shell会将内容自动补充完整。使用制表键自动补全的技巧在于要给shell足够的文件名信息，使其能够将需要的文件与其他文件区分开。当无法完成自动补全时，会听到‘嘟’的一声。要是再按一下制表键，shell就会列出所有匹配的文件名。
　　链接文件是linux文件系统的一个优势。若需要在系统上维护同一个文件的两份或多份备份，除了保存多份单独的物理文件备份外，还可以采用保存一份物理文件副本和多个虚拟副本的方法。这种虚拟的副本就称为链接。链接是目录中指向文件真实位置的占位符。在Linux中有两种不同类型的文件链接：

- 符号链接
- 硬链接

　　符号链接就是一个实实在在的文件，它指向放在虚拟目录结构中某个地方的另一个文件。这两个通过符号链接在一起的文件，彼此的内容并不相同。要为一个文件创建符号链接，原始文件必须事先存在。然后可以使用ln命令以及-s选项来创建符号链接。类似windows下的快捷方式。

	$ ll test*
	-rw-r--r--. 1 root root 520 8月  12 02:20 test
	$ ln -s test test_sl
	$ ll test*
	-rw-r--r--. 1 root root 520 8月  12 02:20 test
	lrwxrwxrwx. 1 root root   4 8月  12 02:21 test_sl -> test
	$ ll -i test*
	529974 -rw-r--r--. 1 root root 520 8月  12 02:24 test
	529745 lrwxrwxrwx. 1 root root   4 8月  12 02:21 test_sl -> test
	$

　　符号链接文件与源文件是两个完全不同的文件，由上例可以看到，源文件为520字节，而符号链接文件只有4字节，并且inode编号也不一样。
　　硬链接会创建独立的虚拟文件，其中包含了原始文件的信息及位置。他们从根本上来说是同一个文件。引用硬链接文件等同于引用了源文件。要创建硬链接，原始文件必须事先存在，只不过这次使用的ln命令时不需要加入额外的参数了。

	$ ll test*
	-rw-r--r--. 1 root root 520 8月  12 02:20 test
	$ ln test test_hl
	$ ll -i test*
	529974 -rw-r--r--. 2 root root 520 8月  12 02:24 test
	529974 -rw-r--r--. 2 root root 520 8月  12 02:24 test_hl

　　带有硬链接的文件共享inode编号，文件大小也一模一样。它们终归是同一个文件。注意：只能对处于同一存储媒体的文件创建硬链接，要想在不同存储媒体的文件之间创建链接，只能使用符号链接。
　　复制链接文件时一定要小心。当复制一个已经被链接到另一个源文件的文件时，得到的是源文件的副本。不需要复制链接文件，可以创建原始文件的另一个链接。千万不要创建软链接文件的软链接，这样会形成混乱的链接链，不仅容易断裂，还会造成各种麻烦。
　　mv命令可以将文件或目录移动到另一个位置或重命名。文件的时间戳和inode编号都不变，改变的只有位置和名称。

	mv <source> <destination>

　　rm命令可以移除文件（removing）。文件一旦移除，就无法找回。在试用rm命令时，习惯加入-i参数。加入-f参数可以不受提示符打扰，强制移除。

	rm -i <file>

##3.7 处理目录##

　　mkdir命令可以创建新目录。

	mkdir <directory>

　　想要同时创建多个目录和子目录，需要加入-p参数，它会根据需要创建缺失的父目录。

	$ mkdir testff/testf/test
	mkdir: 无法创建目录"test/test/test": 没有那个文件或目录
	$ mkdir -p testff/testf/test
	$ ls -R testff
	testff:
	testf

	testff/testf:
	test

	testff/testf/test:
	$

　　移除目录的基本命令rmdir，但它只能删除空目录。rmdir没有-i参数来询问是否移除目录。可以使用rm命令加-r参数（对于rm命令，-r和-R参数的效果是一样的），他会向下进入目录，移除其中的文件，然后移除目录本身。

	$ rmdir testff
	rmdir: 删除 "testff" 失败: 目录非空
	$ rm -ri testff
	rm：是否进入目录"testff"? y
	rm：是否进入目录"testff/testf"? y
	rm：是否进入目录"testff/testf/test"? y
	rm：是否删除普通空文件 "testff/testf/test/testfile"？y
	rm：是否删除目录 "testff/testf/test"？y
	rm：是否删除目录 "testff/testf"？y
	rm：是否删除目录 "testff"？y
	$

　　这样需要确认每个文件或目录是否要移除，可以加-f参数忽略询问强制移除。

	$ rm -rif testff
	$ ls testff
	ls: 无法访问testff: 没有那个文件或目录
	$

　　使用tree工具可以直观的展示目录、子目录及其中的文件。

##3.8 查看文件内容##

　　file命令可以探测文件内部，并决定文件是什么类型。如果是文本文件，还能确定编码方式。如果是链接文件，能够确定他链接在哪个文件上。如果是一个二进制可执行程序，能够确定该程序编译时所面向的平台以及所需类库。

	file <filename>

　　cat命令可以显示文本文件中的所有数据。-n参数可以给所有的行加上行号，-b参数可以只给有文本的行加上行号，-T参数可以将制表符替换为^I。

	$ cat test
	This is a test file

		This is a test file

	This is a test file
	$ cat -n test
	     1	This is a test file
	     2	
	     3		This is a test file
	     4	
	     5	This is a test file
	$ cat -b test
	     1	This is a test file
	
	     2		This is a test file
	
	     3	This is a test file
	$ cat -T test
	This is a test file

	^IThis is a test file

	This is a test file
	$ 

　　cat命令的缺陷是，一旦运行，就无法控制后面的操作，文本会在显示器上一晃而过。
　　more命令则会在显示每页数据之后停下来，在屏幕底部，more命令会显示一个标签，来标明仍然在more程序中以及在文本文件中的位置。和手册页中一样，可以通过空格键换行，回车键逐行前进的方式浏览文本，按q退出。

	more <filename>

　　less命令是more命令的升级版，它提供了一些实用的特性，能够在文本文件中前后翻动，而且还有一些高级搜索的功能。它能够识别方向键以及翻页键。

	less <filename>

　　tail命令会显示文本最后几行的内容，默认情况下显示末尾10行。可以在tail命令中加入参数-n来修改显示的行数。-f参数允许你在其他进程使用该文件时查看文件的内容。tail命令会保持活动状态，并不断显示添加到文件中的内容。这是实时监测系统日志文件的绝妙方式。

	tail [option] <filename>
		-n 修改显示行数
		-f 实时显示

　　head命令与tail命令类似，不过它是显示文件开头的几行内容，默认情况下显示开头10行。也支持-n参数。

	head [option] <filename>
		-n 修改显示行数

#第四章 更多的bash shell命令#

##4.1 监测程序##

　　当程序运行在系统上时，我们称之为进程（process）。ps命令可以监测这些进程。默认情况下，ps命令只会显示运行在当前控制台下的属于当前用户的进程。
　　linux系统中使用的GNU ps命令支持3种不同类型的命令行参数：
- Unix风格的参数，前面加单破折线
- BSD风格的参数，前面不加破折线
- GNU风格的长参数，前面加双破折线

###Unix风格参数###

	 参数                        描述
	-A                        显示所有进程
	-N                        显示与指定参数不符的进程
	-a                        显示除控制进程（session leader）和无终端进程外的所有进程
	-d                        显示除控制台进程外的所有进程
	-e                        显示所有进程
	-C cmdlist                显示包含在cmdlist列表中的进程
	-G grplist                显示组ID在grplist列表中的进程
	-U userlist               显示属主的用户ID在userlist中的进程
	-g grplist                显示会话或组ID在grplist列表中的进程
	-p pidlist                显示PID在pidlist列表中的进程
	-s sesslist               显示会话ID在sesslist列表中的进程
	-t ttylist                显示终端ID在ttylist列表中的进程
	-u userlist               显示有效用户ID在userlist列表中的进程
	-F                        显示更多额外输出（相对-f参数而言）
	-O format                 显示默认的输出列以及format列表指定的特定列
	-M                        显示进程的安全信息
	-c                        显示进程的额外调度器信息
	-f                        显示完整格式的输出
	-j                        显示任务信息
	-l                        显示长列表
	-o format                 仅显示有format指定的列
	-y                        不要显示进程标记（process flag，表明进程状态的标记）
	-Z                        显示安全标签（security context）信息
	-H                        用层级格式来显示进程（树状，用来显示父进程）
	-n namelist               定义了WCHAN列显示的值
	-w                        采用宽输出模式，不限宽度显示
	-L                        显示进程中的线程
	-V                        显示ps命令的版本号

　　一般可以使用ps -ef命令来查看系统上运行的所有进程，其中：

- UID：启动这些进程的用户
- PID：进程的进程ID
- PPID：父进程的进程号（如果该进程是由另一个进程启动的）
- C：进程生命周期中的CPU利用率
- STIME：进程启动时的系统时间
- TTY：进程启动时的终端设备
- TIME：运行进程需要的累积CPU时间
- CMD：启动的程序名称

　　如果想获得更多的信息，可以采用-l参数，它会产生一个长格式的输出，会多出以下列：

- F：内核分配给进程的系统标记
- S：进程的状态（O代表正在运行；S代表在休眠；R表示可运行，正等待运行；Z表示僵化，进程已经结束但父进程已不存在；T表示停止）
- PRI：进程的优先级（越大的数字代表越低的优先级）
- NI：谦让度值，用来参与决定优先级
- ADDR：进程的内存地址
- SZ：假如进程被换出，所需交换空间的大小
- WCHAN：进程休眠的内核函数的地址

###BSD风格的参数###

	 参数                        描述
	T                         显示跟当前终端关联的所有进程
	a                         显示跟任意中断关联的所有进程
	g                         显示所有进程，包括控制进程
	r                         仅显示运行中的进程
	x                         显示所有的进程，包括未分配任何终端的进程
	U userlist                显示归userlist列表中某用户ID所有的进程
	p pidlist                 显示PID在pidlist列表中的进程
	t ttylist                 显示所关联的终端在ttylist列表中的进程
	O format                  除了默认输出的列之外，还输出由format指定的列
	X                         按过去的Linux i386寄存器格式输出
	Z                         将安全信息添加在输出中
	j                         显示任务信息
	l                         采用长模式
	o format                  仅显示由format指定的列
	s                         采用信号格式显示
	u                         采用基于用户的格式显示
	v                         采用虚拟内存格式显示
	N namelist                定义在WCHAN列中使用的值
	O order                   定义显示信息列的顺序
	S                         将数值信息从子进程加到父进程中，比如CPU和内存的使用情况
	c                         显示真实的命令名称（用以启动进程的进程名称）
	e                         显示命令使用的环境变量
	f                         用分层格式来显示进程，表明哪些进程启动了哪些进程
	h                         不显示头信息
	k sort                    指定用以将输出排序的列
	n                         和WCHAN信息一起显示出来，用数值来表示用户ID和组ID
	w                         为较宽屏幕显示宽输出
	H                         将线程按进程来显示
	m                         在进程后显示线程
	L                         列出所有格式指定符
	V                         显示ps命令的版本号

　　大部分输出跟使用Unix风格参数时的输出是一样的，只有一小部分不同。

- VSZ：进程在内存中的大小，以千字节（KB）为单位
- RSS：进程在未换出是占用的物理内存
- STAT：代表当前进程状态的双字符状态码

　　这里的进程状态码（STAT列）使用双字符状态码，比Unix风格输出的单字符状态码更清楚地展示进程的当前状态。第一个字符采用了和Unix风格S列相同的值，表明进程是在休眠、运行还是等待。第二个参数进一步说明进程的状态：

- <：该进程运行在高优先级上
- N：该进程运行在低优先级上
- L：该进程有页面锁定在内存中
- s：该进程是控制进程
- l：该进程是多线程的
- +：该进程运行在前台

###GNU长参数###

